<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<!-- Your interface name here-->
	<title></title>
	<!-- The description of this interfaces here -->
	<meta name="description" content="">
	<!-- Your CSS here -->
</head>
<body>
	<!-- Your markup here -->
	<p>Channel editor</p>
	<TEXTAREA rows="40" cols="80" id="channels"></TEXTAREA><br>
	<button onClick="save();">Save channels</button>
				
	<!-- Scripts -->
	<script src="nutella_lib.js" type="text/javascript"></script>
	<!-- Your scripts here -->
				
	<script type="text/javascript">
	
	// Parse the query parameters
	var query_parameters = NUTELLA.parseURLParameters();

	// Get an instance of nutella. 
	var nutella = NUTELLA.init(query_parameters.broker, query_parameters.app_id, query_parameters.run_id, NUTELLA.parseComponentId());
	
	// (Optional) Set the resourceId
	// nutella.setResourceId('my_resource_id');

	nutella.net.request('channel_names',{},function(message, from){
		for (var i=0; i<message.length; i++)
			if(message[i].printName != "") document.getElementById('channels').value += message[i].printName + ',' + message[i].name + '\n';

	})
	
	function save() {
		var r = []; 
		var t = document.getElementById('channels').value;
		var s = [];
		s = t.split('\n'); 
		for (var i=0; i<s.length; i++){
			var v = [];
			var v = s[i].split(",");
			if (v[0]!="") r[i] = {printName: v[0], name: v[1]};
		};
		nutella.net.publish('set_channel_names',r);
	}
	
	
	</script>
				
</body>
</html>