<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<!-- Your interface name here-->
	<title>Ecosystem History</title>
	<!-- The description of this interfaces here -->
	<meta name="description" content="">
	<!-- Your CSS here -->
</head>
<body>
	<!-- Your markup here -->
	<H2>Ecosystem <input type=text size=1 id="ecosystem"> History</H2>
	Start: 
	<select id="startMonth">
	  <option value="January">January</option>
	  <option value="February">February</option>
	  <option value="March">March</option>
	  <option value="April">April</option>
	  <option value="May">May</option>
	  <option value="June">June</option>
	  <option value="July">July</option>
	  <option value="August">August</option>
	  <option value="September">September</option>
	  <option value="October">October</option>
	  <option value="November">November</option>
	  <option value="December">December</option>
	</select>
	<select id="startDay">
		<script type="text/javascript">
			for(i=1;i<=31;i++) document.write('<option value ="' + i + '">' + i + '</option>');
		</script>
	</select>
	<select id="startYear">
			  <option value="2016">2016</option>
	  <option value="2017">2017</option>
	</select>
	&nbsp&nbspEnd: 
	<select id="endMonth">
	  <option value="January">January</option>
	  <option value="February">February</option>
	  <option value="March">March</option>
	  <option value="April">April</option>
	  <option value="May">May</option>
	  <option value="June">June</option>
	  <option value="July">July</option>
	  <option value="August">August</option>
	  <option value="September">September</option>
	  <option value="October">October</option>
	  <option value="November">November</option>
	  <option value="December">December</option>
	</select>
	<select id="endDay">
		<script type="text/javascript">
			for(i=1;i<=31;i++) document.write('<option value ="' + i + '">' + i + '</option>');
		</script>
	</select>
	<select id="endYear">
			  <option value="2016">2016</option>
	  <option value="2017">2017</option>
	</select>
	<button id="draw" onclick="query();">Draw</button>


	<table style="border-spacing:0px;padding:0;">
		<script type="text/javascript">
		var images = [ 	'https://ltg.cs.uic.edu/WC/icons/species_00.svg', 
				'https://ltg.cs.uic.edu/WC/icons/species_01.svg',
				'https://ltg.cs.uic.edu/WC/icons/species_02.svg',
				'https://ltg.cs.uic.edu/WC/icons/species_03.svg',
				'https://ltg.cs.uic.edu/WC/icons/species_04.svg',
				'https://ltg.cs.uic.edu/WC/icons/species_05.svg',
				'https://ltg.cs.uic.edu/WC/icons/species_06.svg',
				'https://ltg.cs.uic.edu/WC/icons/species_07.svg',
				'https://ltg.cs.uic.edu/WC/icons/species_08.svg',
				'https://ltg.cs.uic.edu/WC/icons/species_09.svg',
				'https://ltg.cs.uic.edu/WC/icons/species_10.svg',
			 ];




			 var label = false;

			for (i=0; i<11; i++) {
				document.write('<tr><td><img src=' + images[i] + ' height=50 width=50></td>');
				document.write('<td><canvas id="myChart' + i + '" width="400" height="50"></td></tr>');
				if (label) {
					document.write('<tr><td></td><td><input type=text size=2 READONLY name="month1"><input type=text size=2 READONLY name="day1"><input type=text size=4 READONLY name="year1"></td></tr>');
				}
//				label = !label;
			}
		</script>
	</table>

	<!-- Scripts -->
	<script src="nutella_lib.js" type="text/javascript"></script>
	<script src="Chart.min.js"></script>

	<!-- Your scripts here -->
	<canvas id="myChart" width="400" height="50"></canvas>
			
	<script type="text/javascript">
	
	// Parse the query parameters
	var query_parameters = NUTELLA.parseURLParameters();
	var ecosystem = query_parameters.INSTANCE;
	if (ecosystem === undefined) ecosystem = 0;
	document.getElementById('ecosystem').value = ecosystem;

	// Get an instance of nutella. 
	var nutella = NUTELLA.init(query_parameters.broker, query_parameters.app_id, query_parameters.run_id, NUTELLA.parseComponentId());
	
	// (Optional) Set the resourceId
	// nutella.setResourceId('my_resource_id');
	
	
	// Your code that uses the nutella instance here
	
	function query(){





		// var m =	document.getElementsByName('month1');
		// for(var i=0; i<m.length; i++){
		// 	m[i].value=document.getElementById('startMonth').selectedIndex+1;
		// }
		// var d =	document.getElementsByName('day1');
		// for(var i=0; i<d.length; i++){
		// 	d[i].value=document.getElementById('startDay').value;
		// }
		// var y =	document.getElementsByName('year1');
		// for(var i=0; i<y.length; i++){
		// 	y[i].value=document.getElementById('startYear').value;
		// }
	};



	
	nutella.net.request('ecosystem_history', {ecosystem:ecosystem}, function(response) {
		var c = response.biotic.length; 
		var max=1;
		var min = 0;
		var WIDTH = 400;
		var xOffset = 20;
		var yOffset = 5;
		var HEIGHT = 50;
		var xUnit = (WIDTH - xOffset - xOffset)/c;
		var yUnit = (HEIGHT - yOffset - yOffset)/max;
		for (var i=0; i<11; i++){
			var ctx = document.getElementById('myChart' + i).getContext('2d');
			ctx.clearRect(0, 0, 800, 50);
			ctx.clearRect(0, 0, WIDTH, HEIGHT);
			ctx.lineWidth = 1.5;
			ctx.strokeStyle = 'black';
			for (var j=0; j<c; j++) {
				ctx.beginPath();
				ctx.moveTo(xOffset + j*xUnit,HEIGHT - yOffset);
				ctx.lineTo(xOffset + j*xUnit, HEIGHT - (yOffset + yUnit*response.biotic[j][i]));
				ctx.closePath();
				ctx.stroke();
			}
		}

	});



	
	</script>
				
</body>
</html>