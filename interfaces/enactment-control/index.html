<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<!-- Your interface name here-->
	<title></title>
	<!-- The description of this interfaces here -->
	<meta name="description" content="">
	<!-- Your CSS here -->
</head>
<body>
		<script src="nutella_lib.js" type="text/javascript"></script>
	<!-- Your scripts here -->
				
	<script type="text/javascript">
	
	// Parse the query parameters
	var query_parameters = NUTELLA.parseURLParameters();

	// Get an instance of nutella. 
	var nutella = NUTELLA.init(query_parameters.broker, query_parameters.app_id, query_parameters.run_id, NUTELLA.parseComponentId());


	nutella.net.request('get_activities',{},function(message,from){ 
		window.document.write('<link rel="stylesheet" type="text/css" href="mystyle.css">'); 
		document.write('Activity &nbsp<select id="activity" onChange="activityChange();">');
		for (var i=0; i<message.length; i++){
			document.write('<option value="',message[i].name,'">',message[i].name,'</option>');
		};
		document.write('</select>&nbsp&nbsp');
		document.write('Room &nbsp<select id="room" onChange="activityChange();">');
		document.write('<option value="Dreesh">Dreesh</option>');
		document.write('<option value="312">312</option>');
		document.write('</select>');
		document.write('Class &nbsp<select  id="class" onChange="classChange();">');
		document.write('<option value="default">default</option>');
		document.write('<option value="6BM">6BM</option>');
		document.write('<option value="6MT">6MT</option>');
		document.write('<option value="6ADF">6ADF</option>');
		document.write('</select><br>');
	});
// <!-- 	<H2>Enactment control</H2>
// 	Activity 
	var currentRun;
	nutella.net.request('get_current_run',{},function(message,from){ 
		currentRun = message; 
		if (currentRun == 'default') document.getElementById('class').selectedIndex = 0;
		if (currentRun == 'guest') document.getElementById('class').selectedIndex = 1;
		if (currentRun == '6BM') document.getElementById('class').selectedIndex = 2;
		if (currentRun == '6MT') document.getElementById('class').selectedIndex = 3;
		if (currentRun == '6ADF') document.getElementById('class').selectedIndex = 4;

	});

	
// 	  <option value="foodweb">foodweb</option>
// 	  <option value="naturalist">naturalist</option>
// 	  <option value="abiotic experimentalist">abiotic experimentalist</option>
// 	  <option value="biotic experimentalist">biotic experimentalist</option>
// 	  <option value="modeler">modeler</option>
// 	  <option value="threat assessor">threat assessor</option>
// 	  <option value="applied ecologist">applied ecologist</option>
// 	</select>
//  -->	
	
	// var activityList = ["naturalist","abiotic experimentalist","biotic experimentalist","modeler","threat analyst","applied ecologist"];

	// nutella.net.request('running',{},function(RUNNING){
	// 	if (RUNNING) {
	// 		document.getElementById('start').disabled = true;
	// 		document.getElementById('stop').disabled = false;
	// 		document.getElementById('reset').disabled = true;
	// 	} else {
	// 		document.getElementById('start').disabled = false;
	// 		document.getElementById('stop').disabled = true;
	// 		document.getElementById('reset').disabled = false;			
	// 	}
	// });

	nutella.net.request('currentActivityAndRoom',{},function(message, from){ 
		for (var i=0; i<document.getElementById('activity').options.length; i++) {
			if (document.getElementById('activity').options[i].value == message.activity) document.getElementById('activity').selectedIndex = i;
		}
		if (message.room == "Dreesh") document.getElementById('room').selectedIndex = 0;
		if (message.room == "312") document.getElementById('room').selectedIndex = 1;
	});

	function classChange(){
		var a = document.getElementById('class').selectedIndex; 
		nutella.net.publish('set_current_run',document.getElementById('class').options[a].value);

	}


	function activityChange() {
		var a = document.getElementById('activity').selectedIndex; 
		var b = document.getElementById('room').selectedIndex; 

		nutella.net.publish('change_activityAndRoom',
			{activity: document.getElementById('activity').options[a].value, room: document.getElementById('room').options[b].value })
	};
	// function startSimulation() {
	// 	var i = document.getElementById('interval').value;
	// 	if (isNaN(i)) {alert('Interval must be a positive integer'); return;}
	// 	if (i<1) {alert('Interval must be a positive integer'); return;}
	// 	nutella.net.publish('start_simulation',i);
	// 	document.getElementById('start').disabled = true;
	// 	document.getElementById('stop').disabled = false;
	// 	document.getElementById('reset').disabled = true;
	// }

	// function stopSimulation() {
	// 	nutella.net.publish('stop_simulation',{});
	// 	document.getElementById('stop').disabled = true;
	// 	document.getElementById('start').disabled = false;
	// 	document.getElementById('reset').disabled = false;
	// }

	// function resetSimulation() {
	// 	nutella.net.publish('reset_history',{});
	// 	document.getElementById('stop').disabled = true;
	// 	document.getElementById('start').disabled = false;
	// 	document.getElementById('reset').disabled = false;
	// }

	
	</script>
				
</body>
</html>